# ==============================
# Core App / Auth
# ==============================
DATABASE_URL=postgresql+psycopg2://postgres:postgres@localhost:5432/document_hub
SECRET_KEY=replace-with-strong-random-secret
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# ==============================
# Storage
# ==============================
# local | s3 (azure planned)
STORAGE_PROVIDER=local

# Local filesystem storage root
STORAGE_DIR=./storage

# S3 settings (used when STORAGE_PROVIDER=s3)
# Leave AWS keys empty in production to use IAM role credentials.
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
S3_BUCKET_NAME=document-hub-files
S3_PREFIX=

# ==============================
# Infra
# ==============================
REDIS_URL=redis://localhost:6379
REDIS_KEY_PREFIX=document-hub
OCR_CLAIM_LOCK_TTL_SECONDS=30
OCR_QUEUE_BLOCK_TIMEOUT_SECONDS=2
OCR_QUEUE_MAX_ATTEMPTS=3
OCR_QUEUE_RETRY_BASE_SECONDS=5
OCR_QUEUE_RETRY_MAX_SECONDS=60
DEBUG=true

# IMPORTANT: comma-separated origins, no spaces in production list
CORS_ORIGINS=http://localhost:8080,http://localhost:3000

# ==============================
# OCR
# ==============================
# internal OCR engine used by /ocr/run/easyocr/{document_id}
OCR_ENGINE=easyocr
OCR_CONFIDENCE_THRESHOLD=0.7

# External OCR trigger integration
OCR_EXTERNAL_URL=http://localhost:9000/ocr/trigger
OCR_EXTERNAL_API_KEY=

# Optional global webhook secret for /ocr/webhook/external
# If set, header X-OCR-SECRET must match this value
OCR_EXTERNAL_WEBHOOK_SECRET=

# Public API base URL used to build callback-accessible document file URL
# Example: https://api.example.com
PUBLIC_BASE_URL=http://localhost:8000



# Phase 1 Configuration
# Add to backend/.env or core/config.py

# LLM Queue Settings
LLM_QUEUE_ENABLED=true
LLM_QUEUE_WORKERS=2  # Number of dedicated LLM workers

# Resource Limits
MAX_WORKER_MEMORY_MB=4096  # 4GB per worker
MAX_WORKER_MEMORY_PERCENT=80.0  # 80% of available memory
MAX_WORKER_CPU_PERCENT=90.0  # 90% CPU usage

# Job Timeouts
EXTRACTION_JOB_TIMEOUT_SECONDS=300  # 5 minutes per extraction job
LLM_TASK_TIMEOUT_SECONDS=120  # 2 minutes per LLM task
OCR_PAGE_TIMEOUT_SECONDS=30  # 30 seconds per page

# OCR Batching
OCR_BATCH_SIZE=5  # Process 5 pages at a time
OCR_MAX_WORKERS=2  # Number of OCR workers

# Monitoring
ENABLE_RESOURCE_MONITORING=true
RESOURCE_MONITOR_INTERVAL_SECONDS=60  # Log metrics every 60s